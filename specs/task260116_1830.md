# 작업계획서: 전체 탭에 눈동자 폴리곤 추가

## 작업 목표
전체 탭에서 눈동자 폴리곤이 별도로 표시되도록 추가합니다.

## 문제 분석
1. **전체 탭에서 눈동자 미표시**: 전체 탭에서 눈동자 폴리곤이 표시되지 않음
2. **눈동자 인덱스 누락**: `tab_renderer.py`에서 전체 탭이 468개 인덱스만 반환하여 눈동자 인덱스(468-477) 제외
3. **폴리곤 렌더링 누락**: `polygon_renderer.py`에서 전체 탭일 때 눈동자 폴리곤을 별도로 그리지 않음

## 작업 계획

### 1. 탭 인덱스에 눈동자 추가
- **위치**: `gui/face_edit/tab_renderer.py` `_get_target_indices_for_tab()` 함수
- **기능**:
  - 전체 탭에서 기본 468개 인덱스(0-467) + 눈동자 10개 인덱스(468-477) 반환
  - 다른 탭도 기본적으로 눈동자 인덱스 포함
- **예상 효과**: 전체 탭에서 눈동자 랜드마크 표시 가능

### 2. 전체 탭에서 눈동자 폴리곤 별도 표시
- **위치**: `gui/face_edit/polygon_renderer.py` `_draw_landmark_polygons()` 함수
- **기능**:
  - 전체 탭에서 눈과 눈동자를 분리하여 표시
  - 왼쪽/오른쪽 눈동자 폴리곤을 별도로 그리기
  - 눈 탭과 동일한 방식으로 눈동자 폴리곤 표시
- **예상 효과**: 전체 탭에서 눈동자 폴리곤이 명확하게 표시됨

## 작업 단계
- [x] 1. 탭 인덱스에 눈동자 추가
  - [x] 1-1. 전체 탭에서 눈동자 인덱스(468-477) 포함하도록 수정
  - [x] 1-2. 다른 탭도 기본적으로 눈동자 인덱스 포함
- [x] 2. 전체 탭에서 눈동자 폴리곤 별도 표시
  - [x] 2-1. 눈과 눈동자 분리하여 표시
  - [x] 2-2. 왼쪽/오른쪽 눈동자 폴리곤 별도로 그리기
  - [x] 2-3. polygon_point_map에 눈동자 인덱스 저장

## 작업 완료 내역
- 2026-01-16 18:30: `tab_renderer.py`에서 전체 탭에 눈동자 인덱스 추가
- 2026-01-16 18:30: `polygon_renderer.py`에서 전체 탭에 눈동자 폴리곤 별도 표시 추가

## 예상 효과
- **사용자 경험**: 전체 탭에서 눈동자도 명확하게 확인 가능
- **일관성**: 눈 탭과 동일한 방식으로 눈동자 표시
- **완전성**: 모든 얼굴 부위가 전체 탭에 포함됨

## 주의사항
- 눈동자 인덱스는 `refine_landmarks=True`일 때만 사용 가능 (468개 이상의 랜드마크 필요)
- MediaPipe 버전에 따라 `FACEMESH_LEFT_IRIS`, `FACEMESH_RIGHT_IRIS`가 없을 수 있음 (예외 처리 필요)

## 구현 세부사항

### 1. 탭 인덱스에 눈동자 추가
```python
elif current_tab == '전체':
    # 전체 탭은 모든 인덱스 (기본 468개 + 눈동자 10개)
    indices = set(range(468))
    # 눈동자 인덱스 추가 (refine_landmarks=True일 때 사용 가능)
    iris_indices = [468, 469, 470, 471, 472, 473, 474, 475, 476, 477]
    for idx in iris_indices:
        indices.add(idx)
    return list(indices)
```

### 2. 전체 탭에서 눈동자 폴리곤 별도 표시
```python
# 왼쪽 눈 (눈동자 제외, 눈동자는 별도로 그림)
draw_polygon_mesh(LEFT_EYE, "polygon_left_eye", "왼쪽 눈", None)

# 왼쪽 눈동자 (별도로 그리기)
if LEFT_IRIS and len(landmarks) > 468:
    left_iris_points = self._get_polygon_from_indices(
        [], landmarks, img_width, img_height, scale_x, scale_y, pos_x, pos_y,
        use_mediapipe_connections=True, connections=LEFT_IRIS, expansion_level=0
    )
    # 폴리곤 그리기 및 클릭 이벤트 바인딩
    # polygon_point_map에 저장
```
