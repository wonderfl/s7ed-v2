# 작업 계획서: Noise Reduction과 Vignette 기능 추가

## 작업 목표
이미지 조정 기능에 Noise Reduction(노이즈 제거)과 Vignette(비네팅) 기능을 추가합니다.

## 추가할 기능

### 1. Noise Reduction (노이즈 제거)
- **용도**: 이미지의 노이즈를 제거하여 품질 개선
- **범위**: 0.0 ~ 100.0 (0=적용 없음, 100=최대 강도)
- **기본값**: 0.0
- **구현 방법**: OpenCV의 bilateralFilter 사용

### 2. Vignette (비네팅)
- **용도**: 주변부를 어둡게/밝게 처리하여 중앙 강조
- **범위**: -100 ~ +100 (-100=주변부 어둡게, +100=주변부 밝게, 0=적용 없음)
- **기본값**: 0.0
- **구현 방법**: 중앙에서 거리에 따라 그라데이션 마스크 생성

## 작업 단계

### 1단계: 변수 추가
- [x] `self.noise_reduction = tk.DoubleVar(value=0.0)` 추가
- [x] `self.vignette = tk.DoubleVar(value=0.0)` 추가

### 2단계: 슬라이더 UI 추가
- [x] Noise Reduction 슬라이더 추가 (3줄에 배치)
- [x] Vignette 슬라이더 추가 (5줄에 배치)
- [x] 라벨 업데이트 변수 추가

### 3단계: 이미지 처리 로직 구현
- [x] `show_extracted_adjusted()`에 Noise Reduction 적용 로직 추가 (Clarity 전)
- [x] `show_extracted_adjusted()`에 Vignette 적용 로직 추가 (Sharpness 후)
- [x] `update_palette_preview()`에 Noise Reduction 적용 로직 추가 (Clarity 전)
- [x] `update_palette_preview()`에 Vignette 적용 로직 추가 (Sharpness 후, 팔레트 적용 전)
- [x] 처리 순서 확인 및 조정

### 4단계: 라벨 업데이트 로직 추가
- [x] `on_adjust_change()`에 Noise Reduction 라벨 업데이트 추가
- [x] `on_adjust_change()`에 Vignette 라벨 업데이트 추가

### 5단계: 초기화 로직 추가
- [x] `reset_adjustments()`에 Noise Reduction 초기화 추가
- [x] `reset_adjustments()`에 Vignette 초기화 추가

## 완료 사항

- Noise Reduction과 Vignette 기능이 성공적으로 추가되었습니다.
- 슬라이더는 3줄(Noise Reduction)과 5줄(Vignette)에 배치되었습니다.
- 이미지 처리 순서:
  - Noise Reduction: Clarity 전에 적용
  - Vignette: Sharpness 후, 팔레트 적용 전에 적용

## 구현 세부사항

### Noise Reduction 구현
- OpenCV의 `cv2.bilateralFilter()` 사용
- d=9 (필터 크기)
- sigmaColor = noise_reduction 값에 비례
- sigmaSpace = noise_reduction 값에 비례

### Vignette 구현
- 이미지 중앙에서 거리 계산
- 거리에 따라 그라데이션 마스크 생성
- 양수: 주변부 밝게 (마스크를 더함)
- 음수: 주변부 어둡게 (마스크를 뺌)

## 참고사항
- 처리 순서는 기존 순서를 유지하되, Noise Reduction은 선명도 조정 전에, Vignette은 마지막에 적용하는 것이 좋을 수 있음
- OpenCV import 필요 여부 확인

