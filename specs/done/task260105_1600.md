# 작업 계획서: 파일 분리 검토

## 현재 상태
- 파일 크기: 1719줄
- 클래스: `FaceExtractPanel` (단일 클래스)
- 메서드 수: 41개

## 논리적 분리 가능 영역

### 1. UI 생성 관련 (이미 분리됨)
- `_create_file_selection_ui`
- `_create_face_area_settings_ui`
- `_create_image_adjustment_ui`
- `_create_palette_settings_ui`
- `_create_manual_region_ui`
- `_create_preview_ui`
- **상태**: 이미 잘 분리됨

### 2. 파일 관리 관련
- `refresh_file_list`
- `on_listbox_key`
- `on_listbox_select`
- `on_file_select`
- `browse_file`
- `load_image`
- **분리 가능성**: 중간 (약 150줄)

### 3. 이미지 처리 및 미리보기 관련
- `show_extracted_original`
- `show_extracted_adjusted`
- `draw_grid_extracted`
- `update_palette_preview`
- `show_palette_preview`
- `show_original_preview`
- `draw_crop_region_on_original`
- `draw_actual_crop_region`
- **분리 가능성**: 높음 (약 400줄)

### 4. 저장 관련
- `save_image`
- `save_extracted_png`
- `save_png`
- **분리 가능성**: 낮음 (약 100줄, 간단함)

### 5. 캔버스 이벤트 처리
- `on_canvas_click`
- `on_canvas_drag`
- `on_canvas_release`
- **분리 가능성**: 중간 (약 100줄)

### 6. 얼굴 추출 로직
- `extract_face`
- `apply_detected_region`
- **분리 가능성**: 중간 (약 200줄)

## 분리 옵션

### 옵션 1: Mixin 클래스 패턴
- `FileManagerMixin`: 파일 관리 관련 메서드
- `PreviewManagerMixin`: 미리보기 관련 메서드
- `CanvasEventHandlerMixin`: 캔버스 이벤트 처리
- **장점**: 기능별로 명확히 분리
- **단점**: Python의 다중 상속 복잡성

### 옵션 2: 별도 모듈로 분리
- `gui/_face_extract_file.py`: 파일 관리
- `gui/_face_extract_preview.py`: 미리보기 관리
- `gui/_face_extract_canvas.py`: 캔버스 이벤트
- **장점**: 파일 단위로 명확히 분리
- **단점**: 클래스가 여러 파일에 분산

### 옵션 3: 현재 상태 유지
- **장점**: 모든 코드가 한 곳에 있어 이해하기 쉬움
- **단점**: 파일이 큼 (1719줄)

## 추천

현재 상태가 나쁘지 않습니다:
1. UI 생성은 이미 잘 분리됨
2. 메서드들이 논리적으로 그룹화되어 있음
3. 1719줄은 큰 편이지만 관리 가능한 수준

**하지만** 다음 경우에는 분리를 고려할 수 있습니다:
- 파일이 2000줄을 넘어갈 때
- 특정 기능(예: 미리보기)이 더 복잡해질 때
- 여러 개발자가 동시에 작업할 때

## 결론

현재는 **분리하지 않는 것을 추천**합니다. 이유:
1. 모든 메서드가 `self`를 통해 상태를 공유
2. UI 생성은 이미 잘 분리됨
3. 파일 크기가 아직 관리 가능한 수준

**대신** 다음을 고려:
- 더 작은 헬퍼 메서드로 분리
- 복잡한 로직을 `utils` 모듈로 이동 (이미 `image_adjustments`로 시작함)

