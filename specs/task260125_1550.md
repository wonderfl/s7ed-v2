# 눈동자 맵핑 방법 선택 기능

## 목표
이미 구현된 중심점-눈동자 외곽선 맵핑과 새로 구현할 중심점-눈랜드마크 맵핑 간 선택 기능을 제공

## 개선 사항

### 1. 두 가지 맵핑 방법
- [x] **방법1**: 중심점 → 눈동자 외곽선 연결 맵핑 (기존 구현)
- [x] **방법2**: 중심점 → 눈 랜드마크 연결 맵핑 (신규 구현)

### 2. 맵핑 방법 선택 UI
- [x] 라디오 버튼으로 맵핑 방법 선택
- [x] 실시간 전환 기능

### 3. 기술 구현 세부사항

#### 3.1 맵핑 방법 열거형 정의
```python
from enum import Enum

class IrisMappingMethod(Enum):
    IRIS_OUTLINE = "iris_outline"    # 중심점 → 눈동자 외곽선 맵핑
    EYE_LANDMARKS = "eye_landmarks"  # 중심점 → 눈 랜드마크 맵핑
```

#### 3.2 맵핑 방법별 구현
- [x] **IRIS_OUTLINE**: 기존 iris_renderer.py의 draw_iris_connections 활용
- [x] **EYE_LANDMARKS**: 눈 랜드마크와 중심점 연결 로직 신규 구현

### 4. 파일 수정 계획

#### 4.1 `gui/face_edit/__init__.py`
- [x] UI 변수 추가:
  ```python
  self.iris_mapping_method = tk.StringVar(value="iris_outline")
  ```

#### 4.2 `gui/face_edit/iris_renderer.py`
- [x] 맵핑 방법에 따른 분기 로직 추가
- [x] 눈 랜드마크 연결 그리기 메서드 추가

#### 4.3 `gui/face_edit/iris_ui.py` (신규)
- [x] 맵핑 방법 선택 라디오 버튼 구현
- [x] 실시간 전환 기능

### 6. 실제 맵핑 방법 적용 (신규 추가)

#### 6.1 눈동자 이동 로직 수정
- [ ] 눈동자 드래그 시 맵핑 방법 파라미터 전달
- [ ] `morph_face_by_polygons` 함수에 맵핑 방법 추가
- [ ] 눈동자 윤곽 재계산 로직에 맵핑 방법 적용

#### 6.2 맵핑 방법별 동작 구현
- [ ] **IRIS_OUTLINE**: 눈동자 외곽선 기반 이동 (기존 동작)
- [ ] **EYE_LANDMARKS**: 눈 랜드마크 기반 이동 (신규 동작)

#### 6.3 파일 수정 계획 (추가)
- [ ] `gui/face_edit/polygon_drag_handler.py`: 맵핑 방법 파라미터 전달
- [ ] `utils/face_morphing/polygon_morphing/core.py`: 맵핑 방법별 처리 로직
- [ ] `utils/face_morphing/polygon_morphing/transformations.py`: 맵핑 방법별 변형 로직

### 7. 구현 우선순위 (수정)
1. 눈 랜드마크 맵핑 기능 구현 (완료) (높음)
2. 맵핑 방법 선택 UI 구현 (완료) (높음)
3. 실시간 전환 기능 (완료) (중간)
4. **실제 맵핑 방법 적용** (높음) ← 신규 추가
5. 눈동자 이동 로직 수정 (높음) ← 신규 추가

## 체크리스트 (수정)

### 단계 1: 눈 랜드마크 맵핑 구현 ✅
- [x] 눈 랜드마크 좌표 가져오기
- [x] 중심점-눈랜드마크 연결선 그리기
- [x] 기능 테스트

### 단계 2: 맵핑 방법 선택 UI ✅
- [x] 라디오 버튼 UI 구현
- [x] 선택값 저장 및 전달
- [x] UI 연동 테스트

### 단계 3: 통합 및 최종 테스트 ✅
- [x] 두 맵핑 방법 간 전환 기능
- [x] 전체 기능 테스트
- [x] 기존 기능과 호환성 확인

### 단계 4: 실제 맵핑 방법 적용 🆕
- [ ] 눈동자 드래그 시 맵핑 방법 파라미터 전달
- [ ] `morph_face_by_polygons` 함수 수정
- [ ] 맵핑 방법별 눈동자 이동 로직 구현
- [ ] 통합 테스트
