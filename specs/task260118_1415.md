# 작업계획서: 하드코딩된 눈동자 인덱스 제거 및 MediaPipe 정의 사용

## 작업 목표
모든 하드코딩된 눈동자 인덱스 [468-477]를 제거하고, MediaPipe의 FACEMESH_LEFT_IRIS, FACEMESH_RIGHT_IRIS 정의를 사용하도록 통일

## 문제점
1. 하드코딩된 인덱스 [468-477]가 여러 파일에 산재되어 있음
2. MediaPipe 실제 정의와 불일치 가능성 (LEFT_IRIS, RIGHT_IRIS 인덱스가 다를 수 있음)
3. 유지보수 어려움: 인덱스 변경 시 여러 곳 수정 필요
4. 버그 발생 가능성: 일관성 없는 코드로 인한 오류

## 해결 방법
1. 공통 유틸리티 함수 생성: `get_iris_indices()` - MediaPipe 정의에서 인덱스 추출
2. 모든 하드코딩된 인덱스를 이 함수 호출로 대체
3. 폴백 처리: MediaPipe가 없을 때만 하드코딩 사용

## 작업 단계

### 1단계: 공통 유틸리티 함수 생성
- [x] `utils/face_morphing/region_extraction.py` 또는 새 파일에 `get_iris_indices()` 함수 추가
- [x] MediaPipe FACEMESH_LEFT_IRIS, FACEMESH_RIGHT_IRIS에서 인덱스 추출
- [x] 폴백: MediaPipe 없을 때만 하드코딩 사용

### 2단계: polygon_morphing.py 수정
- [x] `_calculate_iris_centers` 함수 수정
- [x] `morph_face_by_polygons` 함수 수정
- [x] `transform_points_for_eye_size` 함수 수정

### 3단계: gui/face_edit 파일들 수정
- [x] `morphing.py` 수정
- [x] `polygon_renderer.py` 수정
- [x] `landmark_display.py` 수정
- [x] `tab_renderer.py` 수정

### 4단계: utils/face_morphing 파일들 수정
- [x] `region_extraction.py` 수정
- [x] `adjustments.py` 수정

### 5단계: 테스트 및 검증
- [x] 모든 파일에서 하드코딩 제거 확인 (폴백 제외)
- [x] MediaPipe 정의 사용 확인
- [ ] 기능 정상 작동 확인 (사용자 테스트 필요)

## 예상 효과
1. 코드 일관성 향상: 모든 곳에서 동일한 정의 사용
2. 유지보수성 향상: 한 곳만 수정하면 전체 반영
3. 버그 감소: MediaPipe 정의와 일치 보장
4. 코드 단순화: 하드코딩 제거로 가독성 향상

## 주의사항
- LEFT/RIGHT 매핑 원칙 유지 (절대 변경하지 않음)
- MediaPipe가 없을 때만 폴백으로 하드코딩 사용
- 모든 파일에서 동일한 함수 사용
